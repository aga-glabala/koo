<h1>Cześć, Agnieszka! Najbliższe odbiory: 23.04.2020</h1>
<h2 class="mt-4 mb-4">
    Twoje zamówienia:
    <div class="float-right"><a class="btn btn-primary" routerLink="/myorders">Moje wszystkie zamówienia</a></div>
</h2>
<div class="row">
    <ng-container *ngFor="let userOrder of userOrders | async">
        <div class="col-lg-6" *ngIf="userOrder.order">
            <div class="action-card">
                <div class="row">
                    <div class="col-sm-3 pr-0">
                        <img class="img-fluid" src="http://picsum.photos/400/400">
                    </div>
                    <div class="col-sm-9">
                        <h3>
                            {{userOrder.action.name}}
                            <div class="float-right">
                                <a href="#" class="btn btn-secondary" (click)="open(paymentModal, userOrder.action.payment)">Zapłać</a>&nbsp;
                                <a routerLink="/action/{{userOrder.action.id}}/order" class="btn btn-secondary">Edytuj</a>
                            </div>
                        </h3>
                        <p>{{printProducts(userOrder.action.products)}}</p>
                        <p *ngIf="userOrder.countSum(userOrder.action.products) > userOrder.order.paid" class="text-danger">
                            <svg class="bi bi-clock" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zm8-7A8 8 0 110 8a8 8 0 0116 0z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M7.5 3a.5.5 0 01.5.5v5.21l3.248 1.856a.5.5 0 01-.496.868l-3.5-2A.5.5 0 017 9V3.5a.5.5 0 01.5-.5z" clip-rule="evenodd"/>
                            </svg>
                            <strong> Do zapłaty: {{ userOrder.countSum(userOrder.action.products) }}zł</strong>
                        </p>
                        <p *ngIf="userOrder.countSum(userOrder.action.products) <= userOrder.order.paid" class="text-success">
                            <svg class="bi bi-check-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3-3a.5.5 0 11.708-.708L8 9.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M8 2.5A5.5 5.5 0 1013.5 8a.5.5 0 011 0 6.5 6.5 0 11-3.25-5.63.5.5 0 11-.5.865A5.472 5.472 0 008 2.5z" clip-rule="evenodd"/>
                            </svg>
                            Zapłacone: <strong>{{ userOrder.countSum(userOrder.action.products) }}zł</strong>
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </ng-container>
</div>


<h2 class="mt-5 mb-4">Pomagasz w akcjach:</h2>
<table class="table">
    <thead>
        <th>Akcja</th>
        <th>Zamawiamy</th>
        <th>Płacimy</th>
        <th>Odbiór</th>
        <th>Co robię?</th>
    </thead>
    <tr *ngFor="let action of helperActions | async">
        <td>{{ action.name }}</td>
        <td title="{{ dateHelper.prettyLongDate(action.orderDate) }}">{{ dateHelper.prettyShortDate(action.orderDate) }}</td>
        <td title="{{ dateHelper.prettyLongDate(action.payDate) }}">{{ dateHelper.prettyShortDate(action.payDate) }}</td>
        <td title="{{ dateHelper.prettyLongDate(action.collectionDate) }}">{{ dateHelper.prettyShortDate(action.collectionDate) }}</td>
        <td>TODO</td>
    </tr>
</table>
<h2 class="mt-5 mb-4 clearfix">
    Zbliżające się akcje:
    <div class="float-right">
        <a routerLink="/actions" class="btn btn-success">Zobacz wszystkie akcje</a> 
    </div>
</h2>
<div class="row">
    <div class="col-md-6" *ngFor="let action of actions | async"> 
        <div class="action-card">
            <div class="row">
                <div class="col-md-4">
                    <img class="img-fluid" [src]="action.photoUrl">
                </div>
                <div class="col-md-8">
                    <h3><a routerLink="/action/{{action.id}}">{{ action.name }}</a></h3>
                    <p>Zamawiamy: <strong>3 dni</strong></p>
                    <p>Bierze udział: 56 osób</p>
                    <a routerLink="/action/{{action.id}}/order" class="btn btn-primary">Zamawianie</a>&nbsp;
                    <a routerLink="/action/{{action.id}}/orders" class="btn btn-primary">Tabelka</a>
                </div>
            </div>
        </div>
    </div>  
</div>
<ng-template #paymentModal let-modal>
    <div class="modal-header">
      <h2 class="modal-title" id="modal-basic-title">Płatność</h2>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      {{payment}}
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close()">Zamknij</button>
    </div>
  </ng-template>