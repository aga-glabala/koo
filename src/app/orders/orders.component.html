<div *ngIf="action">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item"><a routerLink="/actions">Akcje</a></li>
            <li class="breadcrumb-item active"><a routerLink="/action/{{ action.id }}">{{ action.name }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">Zamówienia</li>
        </ol>
    </nav>

    <h1 class="mb-1">Zamówienia do akcji {{ action.name }}</h1>
    <p *ngIf="action.createdBy"><strong>Organizator:</strong>{{action.createdBy.name}}</p>
    <p>
        <span *ngIf="action.payLock">Jeszcze nie płacimy</span>
        <span *ngIf="!action.payLock">{{action.payment}}</span>
    </p>
    <p>
        <span title="{{ dateHelper.prettyLongDate(action.orderDate) }}"><strong>Zamówienia do:</strong> {{ dateHelper.prettyShortDate(action.orderDate) }}</span>,&nbsp;
        <span title="{{ dateHelper.prettyLongDate(action.payDate) }}"><strong>Płacimy do:</strong> {{ dateHelper.prettyShortDate(action.payDate) }}</span>,&nbsp;
        <span title="{{ dateHelper.prettyLongDate(action.collectionDate) }}"><strong>Odbieramy:</strong> {{ dateHelper.prettyShortDate(action.collectionDate) }}</span>
    </p>
    <p *ngIf="action.helpers"><span *ngFor="let helper of action.helpers"><strong>{{helper.name}}</strong> {{helper.description}} </span></p>

    <ngb-tabset [destroyOnHide]="false" class="large-tabset">
        <ngb-tab title="Zamówienia w kolumnie">
            <ng-template ngbTabContent>
                <div class="table-container">
                    <table class="table table-striped mt-5">
                        <thead>
                            <tr>
                                <th>Nazwa</th>
                                <th>Wariant</th>
                                <th>Cena</th>
                                <th *ngFor="let customField of action.customFields">{{ customField.name }}</th>
                                <th *ngFor="let order of orders">{{order.ownerName}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let product of action.products">
                                <td>{{product.name}}</td>
                                <td>{{product.variant}}</td>
                                <td>{{product.price}}</td>
                                <td *ngFor="let customField of action.customFields">
                                    <span *ngIf="product.customFields">{{ product.customFields[customField.id] }}</span>
                                </td>
                                <td *ngFor="let order of orders">{{ order.products[product.id] }}</td>
                            </tr>
                            <tr>
                                <td [attr.colspan]="3 + action.customFields.length">Odbiera</td>
                                <td *ngFor="let order of orders">{{ order.pickerName }}</td>
                            </tr>
                            <tr>
                                <td [attr.colspan]="3 + action.customFields.length">Suma</td>                   
                                <td *ngFor="let order of orders"><strong>{{ sums[order.id] }}zł</strong></td>
                            </tr>
                            <tr>
                                <td [attr.colspan]="3 + action.customFields.length"></td> 
                                <ng-container *ngFor="let order of orders">
                                    <!-- komórki z informacją dla wszystkich -->
                                    <td class="bg-success" *ngIf="!actionEditor && order.paid == sums[order.id]">
                                        <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        </svg>
                                        Zapłacone
                                    </td>
                                    <td class="bg-danger" *ngIf="!actionEditor && order.paid != sums[order.id]">
                                        <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                            <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                        </svg>
                                        Nie zapłacone
                                    </td>
                                    <!-- komórki dla właściciela i pomagaczy -->
                                    <td *ngIf="actionEditor">
                                        <button *ngIf="order.paid == sums[order.id]" class="btn btn-success"><svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        </svg> Zapłacone</button>
                                        <button *ngIf="order.paid != sums[order.id]" class="btn btn-danger"><svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                            <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                        </svg> Nie zapłacone</button>
                                    </td>
                                </ng-container>
                            </tr>
                            <tr>
                                <td [attr.colspan]="3 + action.customFields.length"></td> 
                                <ng-container *ngFor="let order of orders">
                                    <!-- komórki z informacją dla wszystkich -->
                                    <td class="bg-success" *ngIf="!actionEditor && order.picked">
                                        <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        </svg> Odebrane
                                    </td>
                                    <td class="bg-danger" *ngIf="!actionEditor && !order.picked">
                                        <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                            <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                        </svg> Nie odebrane
                                    </td>
                                    <td *ngIf="actionEditor">
                                        <button *ngIf="order.picked" class="btn btn-success" (click)="orderPicked(order)"><svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        </svg> Odebrane</button>
                                        <button *ngIf="!order.picked" class="btn btn-danger" (click)="orderPicked(order)"><svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                            <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                        </svg> Nie odebrane</button>
                                    </td>
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </ng-template>
        </ngb-tab>
        <ngb-tab title="Zamówienia w wierszu">
            <ng-template ngbTabContent>
                <div class="table-container">
                    <table class="table table-striped mt-5">
                        <thead>
                            <tr>
                                <th>Nazwa</th>
                                <th *ngFor="let product of action.products">{{product.name}}</th>
                                <th rowspan="3">Odbiera</th>
                                <th rowspan="3">Suma</th>
                                <th rowspan="3">Zapłacone</th>
                                <th rowspan="3">Odebrane</th>
                            </tr>
                            <tr>
                                <th>Wariant</th>
                                <th *ngFor="let product of action.products">{{product.variant}}</th>
                            </tr>
                            <tr>
                                <th>Cena</th>
                                <th *ngFor="let product of action.products">{{product.price}}</th>
                            </tr>
                            <tr *ngFor="let customField of action.customFields">
                                <th>{{ customField.name }}</th>
                                <th *ngFor="let product of action.products"><span *ngIf="product.customFields">{{ product.customFields[customField.id] }}</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let order of orders">
                                <td>{{order.ownerName}}</td>
                                <td *ngFor="let product of action.products">{{ order.products[product.id] }}</td>
                                <td>{{ order.pickerName }}</td>
                                <td><strong>{{ sums[order.id] }}zł</strong></td>

                                <!-- komórki z informacją dla wszystkich -->
                                <td class="bg-success" *ngIf="!actionEditor && order.paid == sums[order.id]">
                                    <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Zapłacone
                                </td>
                                <td class="bg-danger" *ngIf="!actionEditor && order.paid != sums[order.id]">
                                    <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Nie zapłacone
                                </td>
                                <td class="bg-success" *ngIf="!actionEditor && order.picked">
                                    <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                    </svg> Odebrane
                                </td>
                                <td class="bg-danger" *ngIf="!actionEditor && !order.picked">
                                    <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                    </svg> Nie odebrane
                                </td>
                                
                                <!-- komórki dla właściciela i pomagaczy -->
                                <td *ngIf="actionEditor">
                                    <button *ngIf="order.paid == sums[order.id]" class="btn btn-success"><svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                    </svg> Zapłacone</button>
                                    <button *ngIf="order.paid != sums[order.id]" class="btn btn-danger"><svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                    </svg> Nie zapłacone</button>
                                </td>
                                <td *ngIf="actionEditor">
                                    <button *ngIf="order.picked" class="btn btn-success" (click)="orderPicked(order)"><svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                    </svg> Odebrane</button>
                                    <button *ngIf="!order.picked" class="btn btn-danger" (click)="orderPicked(order)"><svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                                    </svg> Nie odebrane</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </ng-template>
        </ngb-tab>
    </ngb-tabset>
</div>